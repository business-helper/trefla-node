const _0x1c48=['vgHHBMSGEw91isbxzsb3AwXSigDLDcbIywnRihrVihLVDsbZB29UlG==','zw1PDa==','C3vIAMvJDa==','A2v5CW==','C3vJy2vZCW==','yxnZAwDU','BgvUz3rO','yMfUx3jLCgX5','ww91igHHDMuGBM8GCgvYBwLZC2LVBIb0BYbYzxbSEsb0AgLZihjLCxvLC3qH','zgvSzxrLqNLjzfjLCq==','C3bSAwnL','Dw52zxjPzNLdAgf0C0j5q2fYza==','zgvSzxrLqNLvC2vY','y2fYzfbHz2LUyxrPB24=','y3jLyxrLsuruCMfUC2zLCLjLCq==','z2v0qNLfBwfPBa==','y29Kzq==','uMvJB3zLCNKGy29KzsbKB2vZig5VDcbTyxrJAce=','zw1HAwW=','BM90AwzPy2f0Aw9U','z2v0q2HHDfrVq2fYza==','w2nOyxqUBgLZDc51CgrHDgvKxsaTls0+','yxbW','yM9KEq==','zMLSDgvY','z2vUzxjHDgvbzg1PBK5VDgLeyxrH','jwnVzguL','B3b0Aw9UywW=','z2vUzxjHDgvoB3rPzMLJyxrPB25eyxrH','Cg9ZDa==','y2fYzfrYyw5ZzMvYuMvXDwvZDefJy2vWDe5VDgLuExbL','y2fYzf9UDw1Izxi=','Bg9JyxrPB25FyxjYyxK=','yMfUuMvWBhLszxe=','vxnLCIbKB2vZBID0igHHDMuGy2fYzcbPBMzVCM1HDgLVBIe=','u0Tux0nbuKrFvKvssuzjruq=','C2f2zq==','BwvZC2fNzq==','B3v0Chv0','DxnLCL9Pzhm=','DxbKyxrLuhjVzMLSzq==','Bg9N','CMvNAxn0zxi=','lI4Vy29UC3rHBNrZl3nVy2TLDc5JB25ZDgfUDa==','y2HHDa==','C29JA2v0x2LK','y3jLyxrL','zw1HAwXFDxnLCM5HBwu=','BwvZC2fNzuLK','y2fYzf92zxjPzMLLza==','Bw9KzwW=','B3b0Aw9UywXFDMfS','C3rHDhvZ','y2f0y2G=','zMfPBgvK','y2fYzfzLCMLMEvjLCxvLC3rszwPLy3roB3rPvhLWzq==','u0Tux0Xuu19tsu5hteu=','w2nOyxrSAxn0xq==','lI4VBw9KzwXZl2LUzgv4','BgfZDe1Zz0LKt25uCMfUC2zLCG==','zgvSzxrLqNLjza==','B3b0Aw9UCW==','ChvZAa==','CMvWBhLuB1rYyw5ZzMvYuMvXDwvZDa==','Aw5JBhvKzxm=','w2nOyxqGBgLZDf0GihjLBw92zwq=','zgvSzxrLvhjHBNnMzxjszxf1zxn0','lI4Vy29UC3rHBNrZl25VDgLMAwnHDgLVBI5JB25ZDgfUDa==','z2v0qNLdyxjK','DgHLBG==','CxvLCNK=','lI4VAgvSCgvYCY9JB21TB24UAgvSCgvYCW==','CMvJB3zLCNLFy29Kzq==','CgfYyw1Z','DMvYAwz5vxnLCG==','v2uGCMvJzwL2zwqGEw91CIbYzxf1zxn0iq==','C3rYAw5N','u0Tux05pveLFtLvnx1vqrefuruq=','Bw9Kzq==','z2v0uhjVzMLSzq==','CMvWBhK=','z2v0qNLjza==','BwfW','Aw5KzxHpzG==','BgfZDf9TzxnZywDLCW==','ufjprKLmrq==','zM9YrwfJAa==','DxbKyxrLqNLjza==','rMfPBgvKihrVigrLBgv0zsb1C2vYiq==','CgfYC2u=','DMvYAwz5vxnLCLjLCq==','vxnLCIbOyxmGyMvLBIb1BNzLCMLMAwvKiq==','BgfZDe1Zz0LUq2HHDa==','zM9Yz290x3bHC3n3B3jK','ywXS','lI4VAgvSCgvYCW==','BNvTyMvYt2zdyxjK','DhjLzMXHidXHzg1PBKb0CMvMBgeUy29TpG==','C2vUzgvYx2LK','ywrTAw5oB3rPzMLJyxrPB24=','DMfS','C3rYAw5NAwz5','BM90Av9UDw0=','w0LeifrYyw5ZzMvYxsbHy2nLChrHyMXL','zgv2AwnLx3rVA2vU','BgLTAxq=','lI4VBw9KzwXZl3vZzxiUBw9KzwW=','z2v0qNLjzhm=','u0Tux0niqvrmsvnux1vqrefuruq=','DxnLCL9Uyw1L','ww91j3jLigfSCMvHzhKGDMvYAwzPzwqH','ANnVBG==','y2fYzf9PBwDFDxjS','CMvZzxrqyxnZD29Yza==','y2fYzfrYyw5ZzMvYuMvXDwvZDfjLAMn0tM90Avr5Cgu=','DxbKyxrLuMvJzwL2zxjjBKnHCMrdAgf0','CMvJzwL2zxjFAwq=','tM8GDMfSAwqGy2fYzcbUDw1IzxiGzM91BMqH','vxnLCIbOyxmGyMvLBIbKzwXLDgvKiq==','Bg9JywXZ','z2v0qNLjzgvUDgLMAwvY','vhjHBNnMzxiGCMvXDwvZDgvYigHHCYbIzwvUigrLBgv0zwqH','CgfNzq==','CgfZC3DVCMq=','DxnLCG==','vxnLCIbKB2vZig5VDcbLEgLZDce=','w3zLCMLMEwLUzYb1C2vYxq==','surFvfjbtLngrvi=','Dg9tDhjPBMC=','uhjVzMLSzsbOyxmGyMvLBIb1CgrHDgvKiq==','lI4VAgvSCgvYCY9HDxrOlMHLBhbLCNm=','BNvTyMvYt2zvC2vYCW=='];(function(_0x2128a1,_0x3fa8ad){const _0x1c4845=function(_0xe55dd4){while(--_0xe55dd4){_0x2128a1['push'](_0x2128a1['shift']());}};_0x1c4845(++_0x3fa8ad);}(_0x1c48,0xbf));const _0xe55d=function(_0x2128a1,_0x3fa8ad){_0x2128a1=_0x2128a1-0x9a;let _0x1c4845=_0x1c48[_0x2128a1];if(_0xe55d['UcYmcD']===undefined){var _0xe55dd4=function(_0x285ee2){const _0x490a8c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=',_0x51f026=String(_0x285ee2)['replace'](/=+$/,'');let _0x37c7d1='';for(let _0x59cb8f=0x0,_0x430216,_0x124442,_0x11aea0=0x0;_0x124442=_0x51f026['charAt'](_0x11aea0++);~_0x124442&&(_0x430216=_0x59cb8f%0x4?_0x430216*0x40+_0x124442:_0x124442,_0x59cb8f++%0x4)?_0x37c7d1+=String['fromCharCode'](0xff&_0x430216>>(-0x2*_0x59cb8f&0x6)):0x0){_0x124442=_0x490a8c['indexOf'](_0x124442);}return _0x37c7d1;};_0xe55d['QnozZX']=function(_0x3e8124){const _0x432446=_0xe55dd4(_0x3e8124);let _0x845a4c=[];for(let _0x377e00=0x0,_0x3f351e=_0x432446['length'];_0x377e00<_0x3f351e;_0x377e00++){_0x845a4c+='%'+('00'+_0x432446['charCodeAt'](_0x377e00)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x845a4c);},_0xe55d['UhgpPt']={},_0xe55d['UcYmcD']=!![];}const _0x1b357a=_0xe55d['UhgpPt'][_0x2128a1];return _0x1b357a===undefined?(_0x1c4845=_0xe55d['QnozZX'](_0x1c4845),_0xe55d['UhgpPt'][_0x2128a1]=_0x1c4845):_0x1c4845=_0x1b357a,_0x1c4845;};const _0x27ee31=_0xe55d,{Validator}=require('node-input-validator'),CONSTS=require(_0x27ee31(0x10e)),NOTI_TYPES=require(_0x27ee31(0xa2)),{ADMIN_NOTI_TYPES}=require(_0x27ee31(0xa2)),models=require(_0x27ee31(0x11d)),User=require(_0x27ee31(0xc9)),helpers=require(_0x27ee31(0xbe)),EmailTemplate=require('../models/emailTemplate.model'),{generateTZTimeString,JSONParser,JSONStringify,respondError,sendMail}=require(_0x27ee31(0xa6)),{comparePassword,generateUserData,genreateAuthToken,generatePassword,getTokenInfo}=require(_0x27ee31(0xe1));exports[_0x27ee31(0x10d)]=async(_0x1b357a,_0x285ee2)=>{const _0x447d23=_0x27ee31;let _0x490a8c=null,_0x51f026;_0x51f026=_0x1b357a['body'][_0x447d23(0x102)]||'';let _0x37c7d1=![],_0x59cb8f=0x0;_0x51f026&&([_0x490a8c]=await models[_0x447d23(0xdb)]['getByCard'](_0x51f026,0x1),_0x490a8c&&(_0x37c7d1=!![],_0x59cb8f=_0x490a8c['id']));const _0x430216=generateUserData({..._0x1b357a[_0x447d23(0xfa)],'card_number':_0x490a8c?'':_0x51f026});return generatePassword(_0x430216[_0x447d23(0xda)])[_0x447d23(0xa4)](_0x124442=>({..._0x430216,'password':_0x124442}))[_0x447d23(0xa4)](async _0x11aea0=>{return User['create'](_0x11aea0);})[_0x447d23(0xa4)](async _0x3e8124=>{const _0x5b13cc=_0x447d23;if(_0x51f026&&!_0x490a8c){let _0x432446=[];await models[_0x5b13cc(0x10f)][_0x5b13cc(0xf7)]({'card_number':_0x3e8124[_0x5b13cc(0x102)]})[_0x5b13cc(0xa4)](_0x845a4c=>{const _0x24f626=_0x5b13cc;_0x432446=_0x845a4c;const _0x377e00=_0x845a4c[_0x24f626(0xb1)](_0x3f351e=>{const _0x580e3e=_0x24f626,_0x432239=JSON[_0x580e3e(0xb8)](_0x3f351e[_0x580e3e(0x10a)]);return _0x432239[0x0];});return User[_0x24f626(0xca)](_0x377e00);})['then'](_0x47c2d6=>{const _0xca2aef=_0x5b13cc,_0x2ee888=_0x1b357a[_0xca2aef(0xf9)]['locals']['socketClient'];_0x47c2d6['forEach']((_0xe0ea0f,_0x3b654b)=>{const _0xb52529=_0xca2aef;_0xe0ea0f['socket_id']&&_0x2ee888[_0xb52529(0xe4)](CONSTS[_0xb52529(0x11b)],{'to':_0xe0ea0f['socket_id'],'event':CONSTS['SKT_REGISTER_WITH_CARD'],'args':{'chat':{...models[_0xb52529(0x10f)][_0xb52529(0x109)](_0x432446[_0x3b654b]),'user':models[_0xb52529(0xdb)][_0xb52529(0x109)](_0x3e8124)}}});});});}return Promise[_0x5b13cc(0xbd)]([_0x3e8124,genreateAuthToken(_0x3e8124)]);})[_0x447d23(0xa4)](([_0x5e60d5,_0x260abc])=>_0x285ee2[_0x447d23(0xce)]({'status':!![],'message':_0x447d23(0xe7),'data':User[_0x447d23(0x109)](_0x5e60d5,'PROFILE'),'token':_0x260abc,'cardVerified':{'exists':_0x37c7d1,'user_id':_0x59cb8f}}))[_0x447d23(0x118)](_0x249b7b=>respondError(_0x285ee2,_0x249b7b));},exports['login']=(_0x2a4c7a,_0x1c6e74)=>{const _0x3d49a6=_0x27ee31;return Promise['all']([User['getByEmail'](_0x2a4c7a[_0x3d49a6(0xfa)][_0x3d49a6(0x112)]),User['getByUserName'](_0x2a4c7a['body'][_0x3d49a6(0x112)])])[_0x3d49a6(0xa4)](([_0x3f2f19,_0x501e11])=>Promise[_0x3d49a6(0xbd)]([_0x3f2f19||_0x501e11,comparePassword(_0x2a4c7a[_0x3d49a6(0xfa)][_0x3d49a6(0xda)],(_0x3f2f19||_0x501e11)[_0x3d49a6(0xda)]),genreateAuthToken(_0x3f2f19||_0x501e11),_0x2a4c7a['body'][_0x3d49a6(0xc7)]!==undefined?User[_0x3d49a6(0x107)]({..._0x3f2f19||_0x501e11,'device_token':_0x2a4c7a[_0x3d49a6(0xfa)][_0x3d49a6(0xc7)]}):null]))['then'](([_0x1ce379,_0x32fe8c,_0x517b9a])=>{const _0x5e77d8=_0x3d49a6;return _0x32fe8c?_0x1c6e74[_0x5e77d8(0xce)]({'status':!![],'message':_0x5e77d8(0xe7),'data':User[_0x5e77d8(0x109)](_0x1ce379,_0x5e77d8(0xb4)),'token':_0x517b9a}):_0x1c6e74[_0x5e77d8(0x117)](0x190)['json']({'status':![],'message':'Password\x20does\x20not\x20match!'});})['catch'](_0x34c9df=>respondError(_0x1c6e74,_0x34c9df));},exports['forgotPassword']=(_0x26ce3d,_0x16e66c)=>{const _0x48667e=_0x27ee31;return Promise[_0x48667e(0xbd)]([User[_0x48667e(0xf2)](_0x26ce3d[_0x48667e(0xfa)][_0x48667e(0xf5)]),EmailTemplate[_0x48667e(0xd7)](_0x48667e(0xbc))])[_0x48667e(0xa4)](([_0x16390a,_0x4d64d1])=>{const _0xa5a9eb=_0x48667e,_0x483902=_0x4d64d1[_0xa5a9eb(0xfa)]['replace'](new RegExp('%Username%'),_0x16390a['user_name'])['replace'](new RegExp(_0xa5a9eb(0xfd)),_0x26ce3d[_0xa5a9eb(0xfa)][_0xa5a9eb(0xf3)]);return Promise[_0xa5a9eb(0xbd)]([sendMail({'from':_0xa5a9eb(0xc0),'to':_0x16390a[_0xa5a9eb(0xf5)],'subject':_0x4d64d1[_0xa5a9eb(0xe5)],'body':_0x483902}),User[_0xa5a9eb(0x107)]({..._0x16390a,'recovery_code':_0x26ce3d['body']['code']})]);})[_0x48667e(0xa4)](([_0x29d7ff,_0x27b404])=>{const _0x4aea39=_0x48667e;return _0x29d7ff&&_0x29d7ff['messageId']?_0x16e66c[_0x4aea39(0xce)]({'status':!![],'message':_0x4aea39(0xe7),'data':{'code':_0x26ce3d[_0x4aea39(0xfa)][_0x4aea39(0xf3)],'messageId':_0x29d7ff[_0x4aea39(0x113)]}}):_0x16e66c['json']({'status':![],'message':_0x4aea39(0x119),'data':_0x29d7ff});})['catch'](_0x44ba40=>respondError(_0x16e66c,_0x44ba40));},exports[_0x27ee31(0xd0)]=(_0x3db438,_0x4fcffb)=>{const _0x5b9e09=_0x27ee31;return Promise[_0x5b9e09(0xbd)]([User[_0x5b9e09(0xf2)](_0x3db438[_0x5b9e09(0xfa)][_0x5b9e09(0xf5)]),generatePassword(_0x3db438['body'][_0x5b9e09(0xda)])])['then'](([_0x32e970,_0x3d497d])=>{const _0x570403=_0x5b9e09;if(_0x32e970[_0x570403(0xa7)]!==_0x3db438['body'][_0x570403(0xf3)])throw Object[_0x570403(0xe8)](new Error(_0x570403(0xf4)),{'code':0x190});else return _0x32e970[_0x570403(0xda)]=_0x3d497d,_0x32e970['recovery_code']='',User[_0x570403(0x107)](_0x32e970);})['then'](_0x31a70d=>_0x4fcffb['json']({'status':!![],'message':_0x5b9e09(0xe7)}))['catch'](_0x4ba1a5=>respondError(_0x4fcffb,_0x4ba1a5));},exports[_0x27ee31(0xb0)]=(_0x4d9aaf,_0x14c5eb)=>{const _0x34fcbb=_0x27ee31,{id:_0x8853fb}=_0x4d9aaf[_0x34fcbb(0xa8)];return User[_0x34fcbb(0xb0)](_0x8853fb)[_0x34fcbb(0xa4)](_0x56dd9b=>{const _0x5067d8=_0x34fcbb;return _0x56dd9b=User[_0x5067d8(0x109)](_0x56dd9b,'PROFILE'),_0x14c5eb[_0x5067d8(0xce)]({'status':!![],'message':_0x5067d8(0xe7),'data':_0x56dd9b});})['catch'](_0x1a492f=>respondError(_0x14c5eb,_0x1a492f));},exports[_0x27ee31(0xae)]=(_0x1642d8,_0x478dcf)=>{const _0x1690f1=_0x27ee31,{uid:_0x276218}=getTokenInfo(_0x1642d8);return User['getById'](_0x276218)[_0x1690f1(0xa4)](_0x1a4f8f=>{const _0x21ca7f=_0x1690f1;return _0x1a4f8f=User[_0x21ca7f(0x109)](_0x1a4f8f,_0x21ca7f(0xb4)),_0x478dcf[_0x21ca7f(0xce)]({'status':!![],'message':_0x21ca7f(0xe7),'data':_0x1a4f8f});})[_0x1690f1(0x118)](_0x33d049=>respondError(_0x478dcf,_0x33d049));},exports['pagination']=(_0x2ca9b9,_0x19cb6e)=>{const _0x58bdf2=_0x27ee31,{uid:_0x102eb0}=getTokenInfo(_0x2ca9b9);return Promise[_0x58bdf2(0xbd)]([User['pagination']({'limit':_0x2ca9b9[_0x58bdf2(0xa5)][_0x58bdf2(0xc8)]||0xa,'page':_0x2ca9b9[_0x58bdf2(0xa5)][_0x58bdf2(0xd9)]||0x0}),User[_0x58bdf2(0xe2)]()])['then'](([_0x2f8ec3,_0x35c382])=>_0x19cb6e[_0x58bdf2(0xce)]({'status':!![],'message':_0x58bdf2(0xe7),'data':_0x2f8ec3['map'](_0x33c377=>User['output'](_0x33c377,_0x2ca9b9[_0x58bdf2(0xa5)][_0x58bdf2(0xad)]||_0x58bdf2(0xb4))),'pager':{'limit':Number(_0x2ca9b9[_0x58bdf2(0xa5)][_0x58bdf2(0xc8)]||0xa),'page':Number(_0x2ca9b9[_0x58bdf2(0xa5)][_0x58bdf2(0xd9)]||0x0),'total':_0x35c382},'hasMore':(_0x2ca9b9[_0x58bdf2(0xa5)][_0x58bdf2(0xd9)]||0x0)*(_0x2ca9b9[_0x58bdf2(0xa5)][_0x58bdf2(0xc8)]||0xa)+_0x2f8ec3[_0x58bdf2(0xe9)]<_0x35c382}))['catch'](_0x453557=>respondError(_0x19cb6e,_0x453557));},exports['cardPagination']=(_0x25ecca,_0x33b378)=>{const _0x336d68=_0x27ee31,{uid:_0x2a640f,role:_0x369e1a}=getTokenInfo(_0x25ecca);let {limit:_0x5373b3,page:_0x3e9253}=_0x25ecca[_0x336d68(0xa5)];return _0x3e9253=Number(_0x3e9253),_0x5373b3=Number(_0x5373b3),Promise[_0x336d68(0xbd)]([User[_0x336d68(0xf0)]({'limit':_0x5373b3,'page':_0x3e9253}),User[_0x336d68(0xbf)]()])['then'](([_0x5e01cb,_0x1dfc2f])=>{const _0xe28cb3=_0x336d68,_0x464c2e=_0x3e9253*_0x5373b3+_0x5e01cb[_0xe28cb3(0xe9)]<_0x1dfc2f;return _0x33b378[_0xe28cb3(0xce)]({'status':!![],'message':'success','data':_0x5e01cb[_0xe28cb3(0xb1)](_0x26f870=>User[_0xe28cb3(0x109)](_0x26f870)),'pager':{'page':_0x3e9253,'limit':_0x5373b3,'total':_0x1dfc2f},'hasMore':_0x464c2e});});},exports[_0x27ee31(0x10b)]=async(_0x406fa6,_0x35d80b)=>{const _0x1f9b5a=_0x27ee31,{uid:_0x44f478}=getTokenInfo(_0x406fa6);let _0x5a2dc5=![],_0x3519cc=0x0,_0x41f15e=_0x406fa6['body']['card_number']||'',_0x303a16,_0x14026c=null,_0x323e20=[];return _0x41f15e&&([_0x14026c]=await User[_0x1f9b5a(0xa3)](_0x41f15e,0x1),_0x14026c=_0x14026c&&_0x14026c['id']!==_0x44f478?_0x14026c:null),User[_0x1f9b5a(0xb0)](_0x44f478)[_0x1f9b5a(0xa4)](async _0x9ef68f=>{const _0x449a18=_0x1f9b5a;_0x303a16=_0x9ef68f[_0x449a18(0x102)]||'';_0x406fa6[_0x449a18(0xfa)][_0x449a18(0x102)]===undefined&&(_0x41f15e=_0x303a16);const _0x4664bf=Object[_0x449a18(0xe6)](_0x9ef68f);_0x4664bf[_0x449a18(0xb5)](_0x149aa3=>{const _0xd288c1=_0x449a18;if(_0x406fa6['body'][_0x149aa3]!==undefined&&_0x149aa3!==_0xd288c1(0x102)){if(['location_array']['includes'](_0x149aa3))_0x9ef68f[_0x149aa3]=JSON[_0xd288c1(0xc4)](_0x406fa6[_0xd288c1(0xfa)][_0x149aa3]);else{if(_0x149aa3===_0xd288c1(0x102)){}else _0x9ef68f[_0x149aa3]=_0x406fa6[_0xd288c1(0xfa)][_0x149aa3]!==undefined?_0x406fa6[_0xd288c1(0xfa)][_0x149aa3]:_0x9ef68f[_0x149aa3];}}});if(_0x41f15e!==_0x303a16&&!_0x14026c){_0x9ef68f['card_number']=_0x41f15e;if(_0x9ef68f[_0x449a18(0x110)]){const _0x4c4628=_0x406fa6[_0x449a18(0xf9)]['locals']['socketClient'];await Promise[_0x449a18(0xbd)]([models[_0x449a18(0x10f)]['getChatToCard']({'card_number':_0x303a16}),models['chat']['getChatToCard']({'card_number':_0x41f15e})])[_0x449a18(0xa4)](([_0x54aca0,_0x3a04ce])=>{const _0x56929f=_0x449a18,_0xe5fa45=[0x0];return _0x3a04ce[_0x56929f(0xb5)](_0x2d87bc=>{const _0x518a81=_0x56929f,_0x28e642=JSON['parse'](_0x2d87bc['user_ids']);_0xe5fa45[_0x518a81(0x9d)](_0x28e642[0x0]);}),Promise[_0x56929f(0xbd)]([_0x54aca0,_0x3a04ce,models[_0x56929f(0xdb)][_0x56929f(0xca)](_0xe5fa45)]);})['then'](([_0x1c41d8,_0x4a19e4,_0x5b6bba])=>{const _0x543f9d=_0x449a18,_0x1bedb9={};_0x5b6bba[_0x543f9d(0xb5)](_0x36d64d=>{const _0x5ac0cb=_0x543f9d;_0x1bedb9[_0x36d64d['id'][_0x5ac0cb(0xdf)]()]=_0x36d64d;});const _0x4c085c=_0x4a19e4[_0x543f9d(0xb1)](_0x1ec2be=>{const _0x2b5a45=_0x543f9d,_0x259580=JSON['parse'](_0x1ec2be['user_ids'])[0x0];return{...models[_0x2b5a45(0x10f)]['output'](_0x1ec2be),'user':models[_0x2b5a45(0xdb)][_0x2b5a45(0x109)](_0x1bedb9[_0x259580[_0x2b5a45(0xdf)]()])};}),_0x151e3b=_0x1c41d8[_0x543f9d(0xb1)](_0x4b436c=>_0x4b436c['id']);_0x4c4628['emit'](CONSTS['SKT_LTS_SINGLE'],{'to':_0x9ef68f[_0x543f9d(0x110)],'event':CONSTS[_0x543f9d(0xcb)],'args':{'removed':_0x151e3b,'added':_0x4c085c}});});}_0x9ef68f['card_verified']&&await models['chat'][_0x449a18(0xee)]({'card_number':_0x303a16}),_0x9ef68f[_0x449a18(0x114)]=0x0;}return User[_0x449a18(0x107)](_0x9ef68f);})['then'](async _0x784e2e=>{const _0x1f3364=_0x1f9b5a;return _0x41f15e&&_0x41f15e!==_0x303a16&&_0x14026c&&(_0x5a2dc5=!![],_0x3519cc=_0x14026c['id']),_0x35d80b[_0x1f3364(0xce)]({'status':!![],'message':_0x1f3364(0xe0),'data':User[_0x1f3364(0x109)](_0x784e2e,_0x1f3364(0xb4)),'cardVerified':{'exists':_0x5a2dc5,'user_id':_0x3519cc}});})[_0x1f9b5a(0x118)](_0x24d6be=>respondError(_0x35d80b,_0x24d6be));},exports[_0x27ee31(0xb6)]=(_0x5cfba1,_0x14e10b)=>{const _0x3383a7=_0x27ee31,{id:_0x3228c2}=_0x5cfba1[_0x3383a7(0xa8)],{uid:_0x4d687e,role:_0x385e43}=getTokenInfo(_0x5cfba1);return User['getById'](_0x3228c2)['then'](_0x258a02=>{const _0x553a05=_0x3383a7,_0x25c159=Object['keys'](_0x258a02);return _0x25c159[_0x553a05(0xb5)](_0x398fb5=>{const _0x42a27a=_0x553a05;[_0x42a27a(0x103)][_0x42a27a(0x9f)](_0x398fb5)?_0x258a02[_0x398fb5]=_0x5cfba1[_0x42a27a(0xfa)][_0x398fb5]?JSON[_0x42a27a(0xc4)](_0x5cfba1[_0x42a27a(0xfa)][_0x398fb5]):_0x258a02[_0x398fb5]:_0x258a02[_0x398fb5]=_0x5cfba1[_0x42a27a(0xfa)][_0x398fb5]!==undefined?_0x5cfba1[_0x42a27a(0xfa)][_0x398fb5]:_0x258a02[_0x398fb5];}),User[_0x553a05(0x107)](_0x258a02);})[_0x3383a7(0xa4)](_0x29323f=>{const _0x314608=_0x3383a7;return _0x14e10b[_0x314608(0xce)]({'status':!![],'message':'User\x20has\x20been\x20updated!','data':User['output'](_0x29323f,'PROFILE')});});},exports[_0x27ee31(0xec)]=(_0x3a7de5,_0x556a30)=>{const _0x5b7da9=_0x27ee31;let _0x51a217=Number(_0x3a7de5[_0x5b7da9(0xa8)]['id']);const {chat:_0x2c84e1,comment:_0x28169b,friend:_0x1c6866,post:_0x5e80b2,report:_0x4c526b}=_0x3a7de5[_0x5b7da9(0xfa)][_0x5b7da9(0x9c)]||{};let _0x5d9ff2=![];return models['user'][_0x5b7da9(0x9b)](_0x51a217)['then'](_0x5e4554=>{const _0x32ab00=_0x5b7da9;_0x5d9ff2=_0x5e4554;if(!_0x5e4554)throw Object[_0x32ab00(0xe8)](new Error(_0x32ab00(0xb7)),{'code':0x190});return Promise['all']([_0x2c84e1?models[_0x32ab00(0x10f)][_0x32ab00(0xef)](_0x51a217):null,_0x28169b?models['comment'][_0x32ab00(0xef)](_0x51a217):null,_0x5e80b2?models[_0x32ab00(0x100)][_0x32ab00(0xef)](_0x51a217):null]);})[_0x5b7da9(0xa4)](([_0x5cb8c6,_0x3630d1,_0x45112e])=>{const _0x1053f9=_0x5b7da9;return{'status':!![],'message':_0x1053f9(0xd5)};});},exports[_0x27ee31(0xb9)]=(_0x485789,_0x578503)=>{const _0x33efff=_0x27ee31,_0x4c956d=Number(_0x485789[_0x33efff(0xa8)]['id']);let _0x174fc9,_0x139cc2;return User[_0x33efff(0xb0)](_0x4c956d)['then'](_0x4f61d0=>{const _0x485229=_0x33efff;if(!_0x4f61d0[_0x485229(0x102)]&&!_0x4f61d0[_0x485229(0xcf)])throw Object['assign'](new Error(_0x485229(0x105)),{'code':0x190});return _0x174fc9=_0x4f61d0,_0x139cc2=_0x4f61d0[_0x485229(0x102)],Promise[_0x485229(0xbd)]([models[_0x485229(0xdb)][_0x485229(0xa3)](_0x4f61d0['card_number']),models[_0x485229(0x10f)][_0x485229(0xf7)]({'card_number':_0x4f61d0[_0x485229(0x102)]})]);})[_0x33efff(0xa4)](([_0x4411a5,_0x5f3986])=>{const _0x3296e9=_0x33efff;return Promise[_0x3296e9(0xbd)]([manageVerificationStatusOfUsers(_0x4411a5,_0x4c956d),processChatroomToCard(_0x5f3986,_0x4c956d)]);})['then'](async([_0x4d955d,_0x5f45a4])=>{const _0x4d27dd=_0x33efff,_0x232a4d=_0x5f45a4[_0x4d27dd(0xb1)](_0x5193c4=>{const _0x4449a7=_0x4d27dd,_0x144d47=JSON[_0x4449a7(0xb8)](_0x5193c4[_0x4449a7(0x10a)]);return _0x144d47[0x0];})[_0x4d27dd(0xfb)]((_0x12b7f5,_0x2170cb,_0x149d40)=>_0x149d40[_0x4d27dd(0xb2)](_0x12b7f5)===_0x2170cb);return await models[_0x4d27dd(0xdb)][_0x4d27dd(0xca)](_0x232a4d)[_0x4d27dd(0xa4)](_0x64aeeb=>{const _0x52a164=_0x4d27dd,_0x299dcd=_0x485789[_0x52a164(0xf9)][_0x52a164(0xd6)]['socketClient'];_0x64aeeb[_0x52a164(0xb5)]((_0x30480c,_0x53265)=>{const _0x32b28c=_0x52a164;if(_0x30480c[_0x32b28c(0x110)]){const [_0x490329]=_0x5f45a4['filter'](_0x5a18d4=>{const _0x3cb533=_0x32b28c,_0x296782=typeof _0x5a18d4[_0x3cb533(0x10a)]===_0x3cb533(0xab)?JSON[_0x3cb533(0xb8)](_0x5a18d4[_0x3cb533(0x10a)]):_0x5a18d4[_0x3cb533(0x10a)];return _0x296782[0x0]===_0x30480c['id'];});_0x299dcd[_0x32b28c(0xe4)](CONSTS['SKT_LTS_SINGLE'],{'to':_0x30480c[_0x32b28c(0x110)],'event':CONSTS[_0x32b28c(0x106)],'args':{'chat':{...models[_0x32b28c(0x10f)][_0x32b28c(0x109)](_0x490329),'user':models[_0x32b28c(0xdb)][_0x32b28c(0x109)](_0x174fc9)}}});}});}),{'status':!![],'message':_0x4d27dd(0xe7),'verified':_0x4d955d,'chatrooms':_0x5f45a4};});},exports[_0x27ee31(0xa9)]=({user_id:_0x5e045a,socketClient:_0x36bd05})=>{const _0x379248=_0x27ee31;let _0x199704,_0x1e3416;return User[_0x379248(0xb0)](_0x5e045a)[_0x379248(0xa4)](_0x1579a5=>{const _0xf27c8e=_0x379248;console[_0xf27c8e(0x10c)](_0xf27c8e(0xdd),_0x5e045a);if(!_0x1579a5[_0xf27c8e(0x102)]&&!_0x1579a5[_0xf27c8e(0xcf)])throw Object[_0xf27c8e(0xe8)](new Error('User\x20doesn\x27t\x20have\x20card\x20information!'),{'code':0x190});return _0x199704=_0x1579a5,_0x1e3416=_0x1579a5[_0xf27c8e(0x102)],Promise[_0xf27c8e(0xbd)]([models[_0xf27c8e(0xdb)]['getByCard'](_0x1579a5['card_number']),models[_0xf27c8e(0x10f)][_0xf27c8e(0xf7)]({'card_number':_0x1579a5[_0xf27c8e(0x102)]})]);})[_0x379248(0xa4)](([_0xfc7c93,_0x4a8265])=>{return Promise['all']([manageVerificationStatusOfUsers(_0xfc7c93,_0x5e045a),processChatroomToCard(_0x4a8265,_0x5e045a)]);})[_0x379248(0xa4)](async([_0x59e344,_0x3a6d3b])=>{const _0x7732a7=_0x379248;[_0x199704]=_0x59e344[_0x7732a7(0xfb)](_0x1971fe=>_0x1971fe['id']===_0x5e045a);const _0x34e41f=_0x3a6d3b[_0x7732a7(0xb1)](_0x3042f4=>{const _0x5146e6=_0x7732a7,_0x282d3e=JSON[_0x5146e6(0xb8)](_0x3042f4[_0x5146e6(0x10a)]);return _0x282d3e[0x0];})[_0x7732a7(0xfb)]((_0x298ba5,_0x3e1139,_0x1813e8)=>_0x1813e8[_0x7732a7(0xb2)](_0x298ba5)===_0x3e1139),_0x5c53ab=helpers['model']['generateNotificationData']({'isFromAdmin':0x1,'sender_id':0x0,'receiver_id':_0x5e045a,'type':NOTI_TYPES['cardVerifyRequestAcceptNotiType'],'optional_val':_0x1e3416,'time':generateTZTimeString()}),_0x65e09=await models[_0x7732a7(0xf6)][_0x7732a7(0x111)](_0x5c53ab);_0x199704[_0x7732a7(0xc5)]++,await models[_0x7732a7(0xdb)][_0x7732a7(0x107)](_0x199704);_0x199704[_0x7732a7(0x110)]&&_0x36bd05[_0x7732a7(0xe4)](CONSTS['SKT_LTS_SINGLE'],{'to':_0x199704['socket_id'],'event':CONSTS[_0x7732a7(0xac)],'args':{'num':_0x199704[_0x7732a7(0xc5)],'notification':_0x65e09}});_0x59e344[_0x7732a7(0xfb)](_0xaf6fcd=>_0xaf6fcd['id']!==_0x5e045a)[_0x7732a7(0xb5)](async _0x7f0297=>{const _0x222cbf=_0x7732a7,_0x1cc6bd=helpers['model'][_0x222cbf(0xff)]({'isFromAdmin':0x1,'sender_id':0x0,'receiver_id':_0x7f0297['id'],'type':NOTI_TYPES[_0x222cbf(0x11a)],'optional_val':_0x1e3416,'time':generateTZTimeString()}),_0x2f6d4b=await models[_0x222cbf(0xf6)][_0x222cbf(0x111)](_0x1cc6bd);_0x7f0297[_0x222cbf(0xc5)]++,await models[_0x222cbf(0xdb)][_0x222cbf(0x107)](_0x7f0297),_0x7f0297[_0x222cbf(0x110)]&&_0x36bd05['emit'](CONSTS[_0x222cbf(0x11b)],{'to':_0x7f0297['socket_id'],'event':CONSTS[_0x222cbf(0xac)],'args':{'num':_0x7f0297[_0x222cbf(0xc5)],'notification':_0x2f6d4b}});});const _0x1b6031=await models[_0x7732a7(0xdb)][_0x7732a7(0xca)](_0x34e41f[_0x7732a7(0xe9)]?_0x34e41f:[0x0]);return console[_0x7732a7(0x10c)](_0x7732a7(0xf8)),_0x59e344[_0x7732a7(0xfb)](_0x5f3cf6=>_0x5f3cf6['socket_id'])[_0x7732a7(0xb5)](_0x55b519=>{const _0x43e9b8=_0x7732a7;console[_0x43e9b8(0x10c)](_0x43e9b8(0x11c),_0x55b519['id'],_0x55b519[_0x43e9b8(0xcc)],_0x55b519[_0x43e9b8(0x114)]);const _0x257c72=[],_0x2031a5=[];_0x55b519['id']===_0x5e045a?(console[_0x43e9b8(0x10c)]('[chat\x20list]\x20\x20added'),_0x36bd05[_0x43e9b8(0xe4)](CONSTS['SKT_LTS_SINGLE'],{'to':_0x55b519[_0x43e9b8(0x110)],'event':CONSTS[_0x43e9b8(0xcb)],'args':{'added':_0x3a6d3b[_0x43e9b8(0xb1)](_0x1c9865=>({...models[_0x43e9b8(0x10f)][_0x43e9b8(0x109)](_0x1c9865),'user':models[_0x43e9b8(0xdb)][_0x43e9b8(0x109)](_0x1b6031[JSONParser(_0x1c9865[_0x43e9b8(0x10a)])[0x0]['toString']()])})),'removed':[],'your_name':_0x55b519['user_name']}})):(console[_0x43e9b8(0x10c)](_0x43e9b8(0xa0)),_0x36bd05[_0x43e9b8(0xe4)](CONSTS['SKT_LTS_SINGLE'],{'to':_0x55b519[_0x43e9b8(0x110)],'event':CONSTS[_0x43e9b8(0xcb)],'args':{'removed':_0x3a6d3b[_0x43e9b8(0xb1)](_0x5328b0=>_0x5328b0['id']),'added':[],'your_name':_0x55b519['user_name']}}));}),_0x1b6031[_0x7732a7(0xb5)]((_0x4f3534,_0x1c2abf)=>{const _0x144894=_0x7732a7;if(_0x4f3534[_0x144894(0x110)]){const [_0x91bc35]=_0x3a6d3b[_0x144894(0xfb)](_0x17e828=>{const _0x422ce5=_0x144894,_0x1fc112=typeof _0x17e828[_0x422ce5(0x10a)]==='string'?JSON[_0x422ce5(0xb8)](_0x17e828[_0x422ce5(0x10a)]):_0x17e828[_0x422ce5(0x10a)];return _0x1fc112[0x0]===_0x4f3534['id'];});_0x36bd05[_0x144894(0xe4)](CONSTS[_0x144894(0x11b)],{'to':_0x4f3534['socket_id'],'event':CONSTS[_0x144894(0x106)],'args':{'chat':{...models['chat'][_0x144894(0x109)](_0x91bc35),'user':models['user'][_0x144894(0x109)](_0x199704)}}});}}),{'status':!![],'message':'success','verified':_0x59e344,'chatrooms':_0x3a6d3b};});},exports['unverifyUserReq']=(_0xbd3e44,_0x1c0a26)=>{const _0x4d92ed=_0x27ee31,{id:_0x2fe2c7}=_0xbd3e44[_0x4d92ed(0xa8)];let _0x1481fa;return User[_0x4d92ed(0xb0)](_0x2fe2c7)[_0x4d92ed(0xa4)](_0x17aed2=>{const _0x907dc=_0x4d92ed,{card_number:_0x8bea73,card_verified:_0x2a1f57}=_0x17aed2;return _0x17aed2[_0x907dc(0x114)]=0x0,Promise['all']([User[_0x907dc(0x107)](_0x17aed2),models['chat'][_0x907dc(0xf7)](_0x8bea73)]);})['then'](([_0x1ec8c9,_0x555adf])=>{if(_0x555adf['length'])return unverifyCardChats(_0x555adf);})[_0x4d92ed(0xa4)](()=>({'status':!![],'message':_0x4d92ed(0xba)}));},exports[_0x27ee31(0x104)]=(_0xfcb9e2,_0x351839)=>{const _0x1e7fdd=_0x27ee31,{uid:_0x4e8ace}=getTokenInfo(_0xfcb9e2);return User[_0x1e7fdd(0xb0)](_0x4e8ace)[_0x1e7fdd(0xa4)](_0x38134c=>{const _0x28a994=_0x1e7fdd;return _0x38134c[_0x28a994(0xea)]=_0xfcb9e2[_0x28a994(0xfa)][_0x28a994(0xaf)],User[_0x28a994(0x107)](_0x38134c);})[_0x1e7fdd(0xa4)](_0xc98f66=>({'status':!![],'message':_0x1e7fdd(0xe3)}));},exports[_0x27ee31(0xf1)]=async({user_id:_0x5b1f74,card_number:_0x2f1e1a,socketClient:_0x277d2c})=>{const _0x519b9a=_0x27ee31;let _0x5b297e,_0x40b8af;return[_0x40b8af]=await models[_0x519b9a(0xdb)][_0x519b9a(0xa3)](_0x2f1e1a,0x1),User[_0x519b9a(0xb0)](_0x5b1f74)[_0x519b9a(0xa4)](_0x33264a=>{const _0x2ac788=_0x519b9a;_0x5b297e=_0x33264a;const _0x4219ce=helpers[_0x2ac788(0x115)][_0x2ac788(0xfc)]({'type':ADMIN_NOTI_TYPES[_0x2ac788(0xde)],'payload':{'from':_0x40b8af['id'],'to':_0x33264a['id'],'card_number':_0x2f1e1a}}),_0x554c5e=helpers['model']['generateNotificationData']({'sender_id':_0x5b1f74,'receiver_id':_0x40b8af['id'],'type':NOTI_TYPES['cardTransferRequestNotiType'],'optional_val':_0x2f1e1a});return _0x40b8af[_0x2ac788(0xc5)]++,Promise[_0x2ac788(0xbd)]([models[_0x2ac788(0xdb)][_0x2ac788(0x107)](_0x40b8af),models[_0x2ac788(0xf6)][_0x2ac788(0x111)](_0x554c5e),models['adminNotification'][_0x2ac788(0x111)](_0x4219ce)]);})[_0x519b9a(0xa4)](([_0x57d5e1,_0x1671b8,_0x18d41c])=>{const _0x30d8da=_0x519b9a;return _0x40b8af[_0x30d8da(0x110)]&&_0x277d2c[_0x30d8da(0xe4)](CONSTS[_0x30d8da(0x11b)],{'to':_0x40b8af[_0x30d8da(0x110)],'event':CONSTS[_0x30d8da(0xac)],'args':{'num':_0x40b8af['noti_num'],'notification':{...models[_0x30d8da(0xf6)][_0x30d8da(0x109)](_0x1671b8),'sender':models[_0x30d8da(0xdb)]['output'](_0x5b297e)}}}),{'status':!![],'message':'You\x20request\x20has\x20been\x20received!'};});},exports[_0x27ee31(0x9e)]=async({user_id:_0x1fce36,noti_id:_0x10c336,accept:_0x437697,socketClient:_0x142f33,..._0x511468})=>{const _0x1dd8e7=_0x27ee31;let _0x1978b9,_0x5d6612;return Promise['all']([models[_0x1dd8e7(0xdb)][_0x1dd8e7(0xb0)](_0x1fce36),models[_0x1dd8e7(0xf6)]['getById'](_0x10c336)])[_0x1dd8e7(0xa4)](([_0x333406,_0x542ffd])=>{const _0x43752f=_0x1dd8e7;_0x1978b9=_0x333406,_0x5d6612=_0x542ffd;if(_0x333406[_0x43752f(0x102)]!==_0x542ffd['optional_val']||_0x542ffd[_0x43752f(0xd3)]!==_0x1fce36)throw Object['assign'](new Error(_0x43752f(0xeb)));return models['user'][_0x43752f(0xb0)](_0x542ffd[_0x43752f(0xc1)]);})['then'](_0x3ffad2=>{const _0x30f15d=_0x1dd8e7;if(!_0x3ffad2)throw Object[_0x30f15d(0xe8)](new Error(_0x30f15d(0xd8)));const _0x131453=helpers['model']['generateNotificationData']({'sender_id':_0x1fce36,'receiver_id':_0x3ffad2['id'],'type':_0x437697?NOTI_TYPES[_0x30f15d(0x101)]:NOTI_TYPES[_0x30f15d(0xd1)],'optional_val':_0x5d6612[_0x30f15d(0x116)]});return _0x1978b9[_0x30f15d(0xc5)]++,Promise['all']([_0x3ffad2,models[_0x30f15d(0xf6)][_0x30f15d(0x111)](_0x131453),models[_0x30f15d(0xc2)][_0x30f15d(0xa1)]({'from':_0x3ffad2['id'],'to':_0x1fce36}),models[_0x30f15d(0xdb)][_0x30f15d(0x107)](_0x1978b9)]);})['then'](async([_0x5de874,_0x57aa51,_0x2e5e7d,_0x340198])=>{const _0x386117=_0x1dd8e7;return _0x5de874[_0x386117(0x110)]&&_0x142f33['emit'](CONSTS[_0x386117(0x11b)],{'to':_0x5de874[_0x386117(0x110)],'event':CONSTS['SKT_NOTI_NUM_UPDATED'],'args':{'num':_0x1978b9[_0x386117(0xc5)],'notification':{...models[_0x386117(0xf6)][_0x386117(0x109)](_0x57aa51),'sender':models[_0x386117(0xdb)][_0x386117(0x109)](_0x1978b9)}}}),_0x437697&&(_0x5de874[_0x386117(0x102)]=_0x57aa51[_0x386117(0xfe)][_0x386117(0xc3)],await models[_0x386117(0xdb)]['save'](_0x5de874),await this[_0x386117(0xa9)]({'user_id':_0x1fce36,'socketClient':_0x142f33}),(_0x1978b9[_0x386117(0x110)]||_0x5de874[_0x386117(0x110)])&&await Promise[_0x386117(0xbd)]([_0x1978b9[_0x386117(0x102)]?models['chat'][_0x386117(0xf7)]({'card_number':_0x1978b9[_0x386117(0x102)]}):[],models[_0x386117(0x10f)][_0x386117(0xf7)]({'card_number':_0x57aa51['optional_val']})])[_0x386117(0xa4)](([_0x5c3ef1,_0x274eef])=>{const _0x44e09c=_0x386117,_0x579035=[0x0];return _0x274eef[_0x44e09c(0xb5)](_0x5b05e8=>{const _0x3d6dd1=_0x44e09c,_0x44e935=JSON['parse'](_0x5b05e8['user_ids']);_0x579035[_0x3d6dd1(0x9d)](_0x44e935[0x0]);}),Promise[_0x44e09c(0xbd)]([_0x5c3ef1,_0x274eef,models[_0x44e09c(0xdb)][_0x44e09c(0xca)](_0x579035)]);})['then'](([_0xd17e61,_0x5b0706,_0x365de5])=>{const _0x39a024=_0x386117,_0x4386cf={};_0x365de5[_0x39a024(0xb5)](_0x1e922e=>{const _0x41f458=_0x39a024;_0x4386cf[_0x1e922e['id'][_0x41f458(0xdf)]()]=_0x1e922e;}),_0x5de874['socket_id']&&_0x142f33[_0x39a024(0xe4)](CONSTS[_0x39a024(0x11b)],{'to':_0x5de874[_0x39a024(0x110)],'event':CONSTS[_0x39a024(0xcb)],'args':{'added':_0x5b0706[_0x39a024(0xb1)](_0x36d81e=>{const _0x1acbab=_0x39a024,_0x118612=JSON[_0x1acbab(0xb8)](_0x36d81e['user_ids'])[0x0];return{...models[_0x1acbab(0x10f)][_0x1acbab(0x109)](_0x36d81e),'user':models[_0x1acbab(0xdb)][_0x1acbab(0x109)](_0x4386cf[_0x118612['toString']()])};}),'removed':_0xd17e61[_0x39a024(0xb1)](_0x2854dc=>_0x2854dc['id'])}}),_0x5de874['socket_id']&&_0x142f33[_0x39a024(0xe4)](CONSTS[_0x39a024(0x11b)],{'to':_0x5de874[_0x39a024(0x110)],'event':CONSTS[_0x39a024(0xcb)],'args':{'added':[],'removed':_0x5b0706[_0x39a024(0xb1)](_0x4a00ff=>_0x4a00ff['id'])}});})),{'status':!![],'message':'You\x20replied\x20to\x20the\x20card\x20transfer\x20request!'};});},exports['createVerifyIdReq']=async(_0x1cd9c6,_0x4c1f9d)=>{const _0x5db345=_0x27ee31,{uid:_0x5b2d25}=getTokenInfo(_0x1cd9c6);let _0x8169a5;return models[_0x5db345(0xdb)][_0x5db345(0xb0)](_0x5b2d25)['then'](_0x5483ef=>{const _0x423490=_0x5db345;if(!_0x5483ef)throw Object['assign'](new Error(_0x423490(0xdc)),{'code':0x190});if(!_0x5483ef['card_number'])throw Object[_0x423490(0xe8)](new Error(_0x423490(0xd4)),{'code':0x190});if(_0x5483ef['card_verified'])throw Object[_0x423490(0xe8)](new Error(_0x423490(0xcd)),{'code':0x190});_0x8169a5=_0x5483ef;const _0x42a22c=helpers['model']['generateAdminNotiData']({'type':ADMIN_NOTI_TYPES['VERIFY_ID'],'payload':{'user_id':_0x5b2d25,'card_number':_0x5483ef['card_number']},'emails':[]});return models['adminNotification'][_0x423490(0x111)](_0x42a22c);})[_0x5db345(0xa4)](_0x4e0bd5=>{const _0x5696d0=_0x5db345;return{'status':!![],'message':_0x5696d0(0xaa)};});};const manageVerificationStatusOfUsers=(_0x32009b,_0x21e2a8)=>{const _0x1878b4=_0x27ee31,_0x37d154=_0x32009b[0x0]['card_number'];return Promise[_0x1878b4(0xbd)](_0x32009b[_0x1878b4(0xb1)](_0x426541=>User[_0x1878b4(0x107)]({..._0x426541,'card_verified':_0x426541['id']===_0x21e2a8?0x1:0x0,'card_number':_0x426541['id']===_0x21e2a8?_0x37d154:'','card_img_url':_0x426541['id']===_0x21e2a8?_0x426541[_0x1878b4(0xcf)]:''})))[_0x1878b4(0xa4)](_0x2ac0f2=>_0x2ac0f2)[_0x1878b4(0x118)](_0x45249d=>{const _0x5e1610=_0x1878b4;return console[_0x5e1610(0x10c)]('[Users\x20verify\x20status]\x20error',_0x45249d),![];});},processChatroomToCard=async(_0x344fee,_0x369dea)=>{const _0x1b506e=_0x27ee31,_0x46f344=await User[_0x1b506e(0xb0)](_0x369dea);return Promise[_0x1b506e(0xbd)](_0x344fee[_0x1b506e(0xb1)](async _0x29f054=>{const _0x4f193f=_0x1b506e,_0x5b4623=JSON[_0x4f193f(0xb8)](_0x29f054['user_ids']),_0x1ca955=![];let _0x24cc5d={};if(!_0x1ca955)_0x24cc5d={'user_ids':JSON[_0x4f193f(0xc4)]([_0x5b4623[0x0],_0x369dea])};else{if(_0x5b4623[_0x5b4623['length']-0x1]!==_0x369dea){console[_0x4f193f(0x10c)](_0x4f193f(0xc6));const _0x14b383=await models['message'][_0x4f193f(0xbb)](_0x29f054['id']),_0x40441d=JSON[_0x4f193f(0xb8)](_0x29f054[_0x4f193f(0x9a)]||'[]'),_0x374da4=JSON[_0x4f193f(0xb8)](_0x29f054[_0x4f193f(0xb3)]||'[]');_0x24cc5d=checkDuplicatedOwner({'user_ids':[..._0x5b4623,_0x369dea],'isTransfered':!![],'lastMsgIdOnTransfer':[..._0x40441d,_0x14b383?_0x14b383['id']:0x0],'last_messages':[..._0x374da4,{'msg':_0x14b383[_0x4f193f(0x108)],'time':_0x14b383['time']}]});}else console[_0x4f193f(0x10c)]('[ID\x20transfer]\x20same\x20id\x20with\x20last\x20owner!'),_0x24cc5d={'card_number':_0x29f054['card_number']};}return _0x24cc5d['id']=_0x29f054['id'],_0x24cc5d[_0x4f193f(0x114)]=0x1,Promise[_0x4f193f(0xbd)]([models['chat'][_0x4f193f(0x107)](_0x24cc5d),models['message']['updateReceiverInCardChat'](_0x29f054['id'],_0x369dea)]);}))['then'](([[_0x208e3f]])=>[_0x208e3f])[_0x1b506e(0x118)](_0x38b149=>{const _0x1ff0df=_0x1b506e;return console[_0x1ff0df(0x10c)]('[Process\x20card\x20chats]\x20error',_0x38b149),![];});},checkDuplicatedOwner=_0x2796fd=>{const _0x2601a7=_0x27ee31;let {user_ids:_0x559cb0,isTransfered:_0xa2e741,lastMsgIdOnTransfer:_0x43f031,last_messages:_0x1c9159}=_0x2796fd;const _0x323a80=_0x559cb0[_0x559cb0[_0x2601a7(0xe9)]-0x1];if(_0x559cb0[_0x2601a7(0xe9)]>0x3){let _0x10bc3f=_0x559cb0[_0x2601a7(0xb2)](_0x323a80);_0x10bc3f>0x0&&_0x10bc3f<_0x559cb0[_0x2601a7(0xe9)]-0x1&&(user['ids']['splice'](_0x10bc3f,0x1),_0x43f031[_0x2601a7(0xed)](_0x10bc3f-0x2,0x1),_0x1c9159[_0x2601a7(0xed)](_0x10bc3f-0x1,0x1));}return{'user_ids':JSON['stringify'](_0x559cb0),'isTransfered':_0xa2e741,'lastMsgIdOnTransfer':JSON[_0x2601a7(0xc4)](_0x43f031),'last_messages':JSON[_0x2601a7(0xc4)](_0x1c9159)};},unverifyCardChats=_0x508f9d=>{const _0x5c8cc7=_0x27ee31;return Promise[_0x5c8cc7(0xbd)](_0x508f9d[_0x5c8cc7(0xb1)](_0x56328f=>{const _0x1a0081=_0x5c8cc7;_0x56328f[_0x1a0081(0x114)]=0x0;const _0x507c51=JSONParser(_0x56328f[_0x1a0081(0x10a)]);return _0x56328f['user_ids']=JSONStringify([_0x507c51[0x0]]),Promise['all']([models[_0x1a0081(0x10f)][_0x1a0081(0x107)](_0x56328f),models[_0x1a0081(0x108)][_0x1a0081(0xd2)](_0x56328f['id'],0x0)]);}))[_0x5c8cc7(0xa4)](([[_0x27b66a,_0x58e9a9]])=>[_0x27b66a]);};