const _0x1f2d=['ndu3m0PTs2XhBW','mJi3mJqYofrzC0DQrG','C2f2zq','mtaXmtqWngDqvMnjzq','z2v0qwXS','nZfhshnvu0K','su5trvjuieLove8GBwvZC2fNzxmGu0vuid8','CgfNAw5HDgLVBG','ChvZAa','DxbKyxrLx3rPBwu','ntGYmvzszKTOsa','zxHWB3j0CW','vvbeqvrfig1LC3nHz2vZifnfvca/ifDirvjfigLKpt8','AwqGpIa','mte0otKWnurVyK9QtG','u0vmrunuicOGrLjptsbTzxnZywDLCYa','mtC3whbKq3jz','AwqGpca','AM9PBG','Dg90ywW','vvbeqvrfia','z2v0twLUswq','CxvLCNK','mti4odC5wvnrueLK','AwqGpd0G','z2v0qNLjza','y3jLyxrLx3rPBwu','ywzMzwn0zwrsB3DZ','revmrvrfiezst00GBwvZC2fNzxmGv0HfuKuGy2HHDf9Pzd0/','BgfZDe1Zz0LUq2HHDa','DxbKyxrLuMvJzwL2zxjjBKnHCMrdAgf0','ieforca','u0vmrunuignVDw50kgLKksbHCYb0B3rHBcbguK9nig1LC3nHz2vZia','ndK2ntuYuNboAeX0','zgvSzxrLqNLjza','y2HHDf9Pzd0','u0vmrunuicOGrLjptsbTzxnZywDLCYbxsevsrsbJAgf0x2LKpt8Gt1jerviGqLKGAwqGrevtqYbmsu1jvcaX','ifDirvjfia','lI4VAgvSCgvYCY9JB21TB24UAgvSCgvYCW','ie9srevsiejzigLKierfu0mSignYzwf0zv90Aw1Lierfu0mGteLnsvqGpW','zgvSzxrLqNLdAgf0swq','mwftzhLSCq','u0vmrunuigLKiezst00GBwvZC2fNzxmGv0HfuKuGy2HHDf9Pzd0','mxHXu2jstG','B3v0Chv0','u0vmrunuicOGrLjptsbTzxnZywDLCYbxsevsrsbPzd0/ieXjtuLuide','y3jLyxrL','nfDRAvnXza'];const _0x1ae7=function(_0x5ef579,_0xf8a351){_0x5ef579=_0x5ef579-0xa5;let _0x1f2dcf=_0x1f2d[_0x5ef579];if(_0x1ae7['OWqQIU']===undefined){var _0x1ae720=function(_0x27e567){const _0x1e4db0='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1d2aab='';for(let _0x180b72=0x0,_0x5ccfea,_0x121910,_0x544928=0x0;_0x121910=_0x27e567['charAt'](_0x544928++);~_0x121910&&(_0x5ccfea=_0x180b72%0x4?_0x5ccfea*0x40+_0x121910:_0x121910,_0x180b72++%0x4)?_0x1d2aab+=String['fromCharCode'](0xff&_0x5ccfea>>(-0x2*_0x180b72&0x6)):0x0){_0x121910=_0x1e4db0['indexOf'](_0x121910);}return _0x1d2aab;};_0x1ae7['xjXzvM']=function(_0x48179e){const _0x135fb9=_0x1ae720(_0x48179e);let _0x17e838=[];for(let _0x424c41=0x0,_0x5ada93=_0x135fb9['length'];_0x424c41<_0x5ada93;_0x424c41++){_0x17e838+='%'+('00'+_0x135fb9['charCodeAt'](_0x424c41)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x17e838);},_0x1ae7['evkbQd']={},_0x1ae7['OWqQIU']=!![];}const _0x5ea90f=_0x1f2d[0x0],_0xef17cd=_0x5ef579+_0x5ea90f,_0x533fb8=_0x1ae7['evkbQd'][_0xef17cd];return _0x533fb8===undefined?(_0x1f2dcf=_0x1ae7['xjXzvM'](_0x1f2dcf),_0x1ae7['evkbQd'][_0xef17cd]=_0x1f2dcf):_0x1f2dcf=_0x533fb8,_0x1f2dcf;};const _0x3f85f1=_0x1ae7;(function(_0xa08fc3,_0x22395e){const _0x5ceb0d=_0x1ae7;while(!![]){try{const _0xfab8e2=-parseInt(_0x5ceb0d(0xb5))*-parseInt(_0x5ceb0d(0xbd))+-parseInt(_0x5ceb0d(0xbf))*parseInt(_0x5ceb0d(0xc7))+parseInt(_0x5ceb0d(0xc9))*parseInt(_0x5ceb0d(0xce))+parseInt(_0x5ceb0d(0xc4))*-parseInt(_0x5ceb0d(0xd4))+-parseInt(_0x5ceb0d(0xd2))+-parseInt(_0x5ceb0d(0xab))*-parseInt(_0x5ceb0d(0xc3))+parseInt(_0x5ceb0d(0xc5));if(_0xfab8e2===_0x22395e)break;else _0xa08fc3['push'](_0xa08fc3['shift']());}catch(_0x42d31b){_0xa08fc3['push'](_0xa08fc3['shift']());}}}(_0x1f2d,0xb1811));const sql=require('./db'),{timestamp,int2Bool}=require(_0x3f85f1(0xba)),table='messages',Message=function(_0x5ea90f={}){const _0x376c28=_0x3f85f1;this[_0x376c28(0xae)]=timestamp(),this['update_time']=timestamp();};Message[_0x3f85f1(0xc2)]=_0xef17cd=>{return _0xef17cd['id']!==undefined?delete _0xef17cd['id']:'',new Promise((_0x533fb8,_0x27e567)=>{const _0x7b87c6=_0x1ae7;sql[_0x7b87c6(0xaa)](_0x7b87c6(0xca),_0xef17cd,(_0x1e4db0,_0x1d2aab)=>{_0x1e4db0?_0x27e567(_0x1e4db0):_0x533fb8({..._0xef17cd,'id':_0x1d2aab['insertId']});});});},Message[_0x3f85f1(0xc6)]=async _0x180b72=>{const _0x265ca0=_0x3f85f1;return _0x180b72[_0x265ca0(0xcd)]=timestamp(),new Promise((_0x5ccfea,_0x121910)=>{const _0x32d43d=_0x265ca0;sql['query'](_0x32d43d(0xd0),[_0x180b72,_0x180b72['id']],(_0x544928,_0x48179e)=>{const _0x4fa448=_0x32d43d;_0x544928?_0x121910(_0x544928):_0x5ccfea(Message[_0x4fa448(0xad)](_0x180b72['id']));});});},Message[_0x3f85f1(0xb6)]=async _0x135fb9=>{return new Promise((_0x17e838,_0x424c41)=>{const _0x42b9a3=_0x1ae7;sql[_0x42b9a3(0xaa)]('DELETE\x20FROM\x20messages\x20WHERE\x20id=?',[_0x135fb9],(_0x5ada93,_0x1feeec)=>{const _0xb3e1ac=_0x42b9a3;_0x5ada93?_0x424c41(_0x5ada93):_0x17e838(_0x1feeec[_0xb3e1ac(0xaf)]>0x0);});});},Message[_0x3f85f1(0xbc)]=async _0x1b5108=>{return new Promise((_0xaf4ca4,_0x49f13c)=>{const _0x5b5379=_0x1ae7;sql[_0x5b5379(0xaa)](_0x5b5379(0xb0),[_0x1b5108],(_0x47596c,_0x4e28ed)=>{const _0x5a484e=_0x5b5379;_0x47596c?_0x49f13c(_0x47596c):_0xaf4ca4(_0x4e28ed[_0x5a484e(0xaf)]>0x0);});});},Message[_0x3f85f1(0xcb)]=async({limit:_0x2d955e,last_id:last_id=null,chat_id:_0x399b18,minId:minId=0x0,maxId:maxId=0x0})=>{const _0x573d22=_0x3f85f1;let _0x8682fc=[_0x573d22(0xb7)+_0x399b18];if(minId)_0x8682fc['push'](_0x573d22(0xd1)+minId);if(maxId)_0x8682fc['push'](_0x573d22(0xac)+maxId);last_id&&_0x8682fc['push'](_0x573d22(0xa5)+last_id);const _0x191001='\x20WHERE\x20'+_0x8682fc[_0x573d22(0xa6)](_0x573d22(0xb3));return new Promise((_0x139513,_0x37732f)=>{const _0x765f37=_0x573d22;sql[_0x765f37(0xaa)](_0x765f37(0xd3)+_0x191001+_0x765f37(0xbb),[_0x2d955e],(_0x1c1a63,_0x491679)=>{_0x1c1a63?_0x37732f(_0x1c1a63):_0x139513(_0x491679);});});},Message[_0x3f85f1(0xc8)]=({chat_id:_0x2ebc6a,minId:minId=0x0,maxId:maxId=0x0})=>{const _0x4bea7e=_0x3f85f1;let _0xd444b3=['chat_id='+_0x2ebc6a];if(minId)_0xd444b3[_0x4bea7e(0xcc)](_0x4bea7e(0xd1)+minId);if(maxId)_0xd444b3['push']('id\x20<=\x20'+maxId);const _0xc0dd72=_0x4bea7e(0xb9)+_0xd444b3['join'](_0x4bea7e(0xb3));return new Promise((_0x24fe5c,_0x1300fc)=>{const _0x53a6e0=_0x4bea7e;sql[_0x53a6e0(0xaa)](_0x53a6e0(0xb4)+_0xc0dd72,(_0x9a35a1,_0x4a7990)=>{const _0x469ca5=_0x53a6e0;_0x9a35a1?_0x1300fc(_0x9a35a1):_0x24fe5c(_0x4a7990[0x0][_0x469ca5(0xa7)]);});});},Message[_0x3f85f1(0xa9)]=({chat_id:_0x577c6f})=>{const _0x1245b1=_0x3f85f1,_0x19b456=_0x1245b1(0xbe)+_0x577c6f+'\x20ORDER\x20BY\x20id\x20ASC\x20LIMIT\x201';return new Promise((_0x444785,_0x46b2ad)=>{const _0x3dad5c=_0x1245b1;sql[_0x3dad5c(0xaa)](_0x19b456,[],(_0x59859c,_0x52b467)=>{_0x59859c?_0x46b2ad(_0x59859c):_0x444785(_0x52b467['length']>0x0?_0x52b467[0x0]['id']:0x0);});});},Message[_0x3f85f1(0xad)]=_0x390613=>{return new Promise((_0x3c8241,_0x67158a)=>{const _0x41388d=_0x1ae7;sql[_0x41388d(0xaa)](_0x41388d(0xc1),[_0x390613],(_0x5502bd,_0x3384c2)=>{_0x5502bd?_0x67158a(_0x5502bd):_0x3c8241(_0x3384c2[0x0]);});});},Message[_0x3f85f1(0xb1)]=_0x378f2f=>{return new Promise((_0x274341,_0x2a21bf)=>{const _0x47d228=_0x1ae7;sql[_0x47d228(0xaa)](_0x47d228(0xb8),[_0x378f2f],(_0x1994e4,_0x54eb1b)=>{_0x1994e4?_0x2a21bf(_0x1994e4):_0x274341(_0x54eb1b[0x0]);});});},Message[_0x3f85f1(0xb2)]=(_0x1cbb99,_0x2022cb)=>{return new Promise((_0x5a5d94,_0x2536e0)=>{const _0x2aa6c3=_0x1ae7;sql[_0x2aa6c3(0xaa)](_0x2aa6c3(0xa8)+table+'\x20SET\x20receiver_id=?\x20WHERE\x20chat_id=?',[_0x2022cb,_0x1cbb99],(_0x15384d,_0x5c4137)=>{_0x15384d?_0x2536e0(_0x15384d):_0x5a5d94(_0x5c4137['affectedRows']);});});},Message[_0x3f85f1(0xc0)]=_0x3e6486=>{const _0xa02318=_0x3f85f1,_0x1857ce=[_0xa02318(0xae),_0xa02318(0xcd)];return _0x1857ce['forEach'](_0x7a45a8=>{_0x3e6486[_0x7a45a8]!==undefined?delete _0x3e6486[_0x7a45a8]:null;}),_0x3e6486;},module[_0x3f85f1(0xcf)]=Message;